<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Recriando o comando cat do Linux em C</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <header>
    <nav>
      <a href="/">Início</a>
      <a href="/blog/">Blog</a>
      <a href="/portfolio/">Portfólio</a>
      <a href="/curriculo.pdf" download>Currículo</a>
    </nav>
  </header>

  <main>
    <p>No dia a dia, nós usuários de Linux costumamos utilizar uma série de programas simples, porém extremamente úteis. Um que eu utilizo com frequência é o <strong>cat</strong> - que nos permite exibir no terminal o conteúdo de um arquivo. Porém, você já parou para pensar em como esse programinha funciona?</p>
<p>Suponhamos que eu queira conferir o conteúdo do arquivo <em>toc_toc.txt</em>:</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ksajx58p1pd031rad5u8.png" alt="Image description"></p>
<p>Ao chamar o comando <strong>cat</strong> eu forneço como argumento o arquivo que eu quero exibir e, como resposta, no terminal é exibido o que o tal arquivo contem. Portanto, se quisermos recriar esse comando, o primeiro passo será receber um argumento por linha de comando.</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/spizggosk3i81hpnf88t.png" alt="Image description"></p>
<p>Na linha 5 nós estamos definindo dois parâmetros para a função main:</p>
<ul>
<li><strong>argc</strong>: conta quantos argumentos foram passados pela linha de comando na hora que o programa foi executado;</li>
<li><strong>argv</strong>: é um vetor com todos os argumentos passados</li>
</ul>
<p>Note que todo programa terá, no mínimo, um argumento - o nome do programa. Por isso checamos se o <strong>argc</strong> é menor do que 2, pois caso seja isso é um sinal de que o nome do arquivo que o <strong>cat</strong> deverá exibir o conteúdo não foi fornecido. Nesse caso, exibimos uma mensagem informando a maneira correta de utilizar o programa e encerramos a execução com um código de erro.</p>
<p>Se o programa recebeu os devidos argumentos quando foi executado, o próximo passo é abrirmos o arquivo cujo o nome foi informado.</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/wjtbtnm5vyfir82zlod2.png" alt="Image description"></p>
<p>Fazemos isso declarando um ponteiro para um arquivo e abrindo ele em seguida.</p>
<p>Na linha 15 nós checamos se tudo ocorreu de forma adequada na abertura do arquivo. Caso algum problema tenha ocorrido, exibimos uma mensagem de erro e encerramos a exceução do programa.</p>
<p>Por fim, temos um loop que irá ler caracter por caracter do nosso arquivo até chegar ao final - exibindo esses caracteres no terminal.</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/826mx4ad11eviunymg9x.png" alt="Image description"></p>
<p>Após finalizarmos a leitura e exibição do conteúdo do arquivo, nós fechamos o arquivo e encerramos o programa.</p>
<p>Agora é só compilar e testar.</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gx0iit8okcgqtovs2paq.png" alt="Image description"></p>
<p>Funciona!!!</p>
<p>Uma coisa importante a dizer é que a implementação do <strong>cat</strong> original é bem mais complexa (<a href="https://github.com/coreutils/coreutils/blob/master/src/cat.c">código fonte aqui</a>) e tem 800 linhas. Porém, a ideia dessa implementação que fizemos é apenas entender como certos programas que utilizamos no dia a dia funcionam na sua forma mais básica. Aliás, apesar da nossa implementação ser muito mais simples que a original, se compararmos as saídas do nosso programa e do <strong>cat</strong> do Linux, vamos ver que ambos produzem a mesma saída.</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/rzt3z5saciitupobpwgg.png" alt="Image description"></p>
<p>Tentar recriar esses utilitários de sistema operacional é uma ótima forma de dar os primeiros passos no desenvolvimento baixo nível e aprofundar os conhecimentos em linguagens como C. Por falar em baixo nível, como seria implementar o <strong>cat</strong> em Assembly? Eu vou fazer os meus testes e volto para te contar.</p>
<p>Fique bem até lá :)</p>

  </main>

  <footer>
    <p>© <script>document.write(new Date().getFullYear())</script> Márcio Scotuzzi Jr. — <a href="mailto:scotuzzijunior@gmail.com">Contato</a></p>
  </footer>
</body>
</html>
